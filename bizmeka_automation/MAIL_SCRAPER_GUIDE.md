# Bizmeka ë©”ì¼ ìŠ¤í¬ë˜í¼ ì‚¬ìš© ê°€ì´ë“œ

## ğŸ¯ ëª©ì 
Bizmeka ì›¹ë©”ì¼ì—ì„œ ë°›ì€ ë©”ì¼í•¨ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•˜ì—¬ Excel íŒŒì¼ë¡œ ì €ì¥

## ğŸ“‹ ì „ì œ ì¡°ê±´
1. **ì¿ í‚¤ íŒŒì¼ í•„ìš”**: `manual_login.py`ë¡œ ë¨¼ì € ë¡œê·¸ì¸í•˜ì—¬ ì¿ í‚¤ ì €ì¥
2. **pandas ì„¤ì¹˜**: `pip install pandas openpyxl`

## ğŸš€ ì‹¤í–‰ ë°©ë²•

### ë°©ë²• 1: ë””ë²„ê·¸ ëª¨ë“œ (ì²« ì‹¤í–‰ ê¶Œì¥)
```bash
python mail_scraper_debug.py
```
ë˜ëŠ”
```bash
run_debug.bat
```

**ë””ë²„ê·¸ ëª¨ë“œ íŠ¹ì§•:**
- ë¸Œë¼ìš°ì €ê°€ ë³´ì´ëŠ” ìƒíƒœë¡œ ì‹¤í–‰ (headless=False)
- ë‹¨ê³„ë³„ë¡œ ìŠ¤í¬ë¦°ìƒ· ì €ì¥
- í˜ì´ì§€ êµ¬ì¡° ë¶„ì„ ì •ë³´ ì¶œë ¥
- ìˆ˜ë™ìœ¼ë¡œ ë©”ì¼/ë°›ì€ë©”ì¼í•¨ ë²„íŠ¼ í´ë¦­ ê°€ëŠ¥

### ë°©ë²• 2: ìë™ ì‹¤í–‰
```bash
python mail_scraper.py
```
ë˜ëŠ”
```bash
run_mail_scraper.bat
```

**ìë™ ì‹¤í–‰ í”„ë¡¬í”„íŠ¸:**
```
ìˆ˜ì§‘í•  í˜ì´ì§€ ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ê¸°ë³¸: 3): [Enter ë˜ëŠ” ìˆ«ì ì…ë ¥]
```

## ğŸ“Š ì¶œë ¥ íŒŒì¼

### Excel íŒŒì¼ ìœ„ì¹˜
`data/bizmeka_mails_YYYYMMDD_HHMMSS.xlsx`

### Excel íŒŒì¼ êµ¬ì¡°
| í˜ì´ì§€ | ë³´ë‚¸ì‚¬ëŒ | ì œëª© | ë‚ ì§œ | ìˆ˜ì§‘ì‹œê°„ |
|--------|----------|------|------|----------|
| 1 | í™ê¸¸ë™ | íšŒì˜ ì•ˆë‚´ | 2025-01-10 | 2025-01-10 14:30:00 |
| 1 | ê¹€ì² ìˆ˜ | í”„ë¡œì íŠ¸ ì§„í–‰ì‚¬í•­ | 2025-01-10 | 2025-01-10 14:30:00 |
| 2 | ì´ì˜í¬ | ë³´ê³ ì„œ ê²€í†  ìš”ì²­ | 2025-01-09 | 2025-01-10 14:30:01 |

### ë””ë²„ê·¸ íŒŒì¼
- `data/debug/step1_main.png` - ë©”ì¸ í˜ì´ì§€
- `data/debug/step2_mail.png` - ë©”ì¼ í˜ì´ì§€
- `data/debug/step3_inbox.png` - ë°›ì€ë©”ì¼í•¨
- `data/debug/inbox_page.html` - HTML êµ¬ì¡°

## âš ï¸ ë¬¸ì œ í•´ê²°

### ë©”ì¼ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŒ
**ì¦ìƒ**: "ë©”ì¼ ë²„íŠ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
**í•´ê²°**:
1. ë””ë²„ê·¸ ëª¨ë“œë¡œ ì‹¤í–‰
2. ìˆ˜ë™ìœ¼ë¡œ ë©”ì¼ ë²„íŠ¼ í´ë¦­
3. ì„ íƒì ì •ë³´ í™•ì¸ í›„ ì½”ë“œ ìˆ˜ì •

### ë°›ì€ë©”ì¼í•¨ ì ‘ì† ì‹¤íŒ¨
**ì¦ìƒ**: "ë°›ì€ë©”ì¼í•¨ ë²„íŠ¼ ì—†ìŒ"
**í•´ê²°**:
- ì´ë¯¸ ë°›ì€ë©”ì¼í•¨ì— ìˆì„ ìˆ˜ ìˆìŒ (ì •ìƒ)
- ë””ë²„ê·¸ ëª¨ë“œë¡œ êµ¬ì¡° í™•ì¸

### ë°ì´í„° ìˆ˜ì§‘ ì‹¤íŒ¨
**ì¦ìƒ**: 0ê°œ ë©”ì¼ ìˆ˜ì§‘
**í•´ê²°**:
1. `inbox_page.html` íŒŒì¼ í™•ì¸
2. í…Œì´ë¸” êµ¬ì¡° ë¶„ì„
3. ì„ íƒì ìˆ˜ì • í•„ìš”

## ğŸ”§ ì»¤ìŠ¤í„°ë§ˆì´ì§•

### ìˆ˜ì§‘ í˜ì´ì§€ ìˆ˜ ë³€ê²½
```python
# mail_scraper.py ì‹¤í–‰ì‹œ
scraper.run(max_pages=5)  # 5í˜ì´ì§€ ìˆ˜ì§‘
```

### ìˆ˜ì§‘ í•„ë“œ ì¶”ê°€
```python
# mail_scraper.pyì˜ scrape_mail_page ë©”ì„œë“œ ìˆ˜ì •
# ì˜ˆ: ì²¨ë¶€íŒŒì¼ ì—¬ë¶€ ì¶”ê°€
attachment = await row.query_selector('img[alt*="ì²¨ë¶€"]')
has_attachment = 'ìˆìŒ' if attachment else 'ì—†ìŒ'
```

### ì„ íƒì ìˆ˜ì •
```python
# ë©”ì¼ ë²„íŠ¼ ì„ íƒì ì¶”ê°€
mail_selectors = [
    'a[href*="mail"]',
    'button:has-text("ë©”ì¼")',
    # ìƒˆ ì„ íƒì ì¶”ê°€
    'div.mail-button',  # ì˜ˆì‹œ
]
```

## ğŸ“ ë¡œê·¸ í™•ì¸
```bash
# ì˜¤ëŠ˜ ë¡œê·¸ ë³´ê¸°
python utils.py --show-logs today
```

## ğŸ”„ ì „ì²´ í”„ë¡œì„¸ìŠ¤

```mermaid
graph TD
    A[ì‹œì‘] --> B[ì¿ í‚¤ ë¡œë“œ]
    B --> C{ì¿ í‚¤ ìœ íš¨?}
    C -->|No| D[manual_login.py ì‹¤í–‰]
    C -->|Yes| E[ìë™ ë¡œê·¸ì¸]
    E --> F[ë©”ì¼ ë²„íŠ¼ í´ë¦­]
    F --> G[ë°›ì€ë©”ì¼í•¨ ì ‘ì†]
    G --> H[í˜ì´ì§€ 1 ìŠ¤í¬ë˜í•‘]
    H --> I[ë‹¤ìŒ í˜ì´ì§€]
    I --> J[í˜ì´ì§€ 2 ìŠ¤í¬ë˜í•‘]
    J --> K[ë‹¤ìŒ í˜ì´ì§€]
    K --> L[í˜ì´ì§€ 3 ìŠ¤í¬ë˜í•‘]
    L --> M[Excel ì €ì¥]
    M --> N[ì™„ë£Œ]
```

## ğŸ’¡ íŒ

1. **ì²« ì‹¤í–‰ì€ ë””ë²„ê·¸ ëª¨ë“œë¡œ**: í˜ì´ì§€ êµ¬ì¡° íŒŒì•…
2. **3í˜ì´ì§€ë¡œ í…ŒìŠ¤íŠ¸**: ì „ì²´ ìˆ˜ì§‘ ì „ ì‘ì€ ë‹¨ìœ„ë¡œ í…ŒìŠ¤íŠ¸
3. **ì •ê¸° ì‹¤í–‰**: Windows ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ ë“±ë¡ ê°€ëŠ¥
4. **ëŒ€ëŸ‰ ìˆ˜ì§‘ì‹œ**: headless=Trueë¡œ ì„¤ì • (config.json)

## ğŸ› ë””ë²„ê¹… ëª…ë ¹

```python
# Python ì½˜ì†”ì—ì„œ ì§ì ‘ í…ŒìŠ¤íŠ¸
from mail_scraper import MailScraper
import asyncio

scraper = MailScraper()
asyncio.run(scraper.run(max_pages=1))
```

## ğŸ“ ì§€ì›
- ë¡œê·¸ íŒŒì¼: `data/logs/`
- ìŠ¤í¬ë¦°ìƒ·: `data/debug/`
- HTML êµ¬ì¡°: `data/debug/inbox_page.html`