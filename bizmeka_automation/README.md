# Bizmeka ìë™í™” ì†”ë£¨ì…˜

## ğŸ“Œ í•µì‹¬ ì›ë¦¬
**ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜ ì¬ì‚¬ìš©** - í•œ ë²ˆ ìˆ˜ë™ ë¡œê·¸ì¸ í›„ ì¿ í‚¤ë¥¼ ì €ì¥í•˜ì—¬ 2ì°¨ ì¸ì¦ ì—†ì´ ìë™ ì ‘ê·¼

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1ë‹¨ê³„: ìˆ˜ë™ ë¡œê·¸ì¸ (ìµœì´ˆ 1íšŒ)
```bash
python bizmeka_automation/manual_login.py
```
- ë¸Œë¼ìš°ì €ê°€ ìë™ìœ¼ë¡œ ì—´ë¦¼
- ìˆ˜ë™ìœ¼ë¡œ ë¡œê·¸ì¸ + 2ì°¨ ì¸ì¦ ì™„ë£Œ
- ì¿ í‚¤ ìë™ ì €ì¥

### 2ë‹¨ê³„: ìë™ ì ‘ê·¼ (ë°˜ë³µ ì‚¬ìš©)
```bash
python bizmeka_automation/auto_access.py
```
- ì €ì¥ëœ ì¿ í‚¤ë¡œ ìë™ ë¡œê·¸ì¸
- 2ì°¨ ì¸ì¦ ì—†ì´ ì ‘ê·¼

### 3ë‹¨ê³„: ë©”ì¼ ë°ì´í„° ìˆ˜ì§‘ (ì„ íƒ)
```bash
# ë©”ì¼ ìŠ¤í¬ë˜í•‘ (3í˜ì´ì§€)
python bizmeka_automation/mail_scraper.py

# ë””ë²„ê·¸ ëª¨ë“œ (êµ¬ì¡° ë¶„ì„)
python bizmeka_automation/mail_scraper_debug.py
```
- ë©”ì¼í•¨ ìë™ ì ‘ì†
- ë°›ì€ ë©”ì¼ ë°ì´í„°ë¥¼ Excelë¡œ ì €ì¥

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
bizmeka_automation/
â”œâ”€â”€ README.md              # ì´ ë¬¸ì„œ
â”œâ”€â”€ config.json           # ì„¤ì • íŒŒì¼
â”œâ”€â”€ manual_login.py       # ìˆ˜ë™ ë¡œê·¸ì¸ ëª¨ë“ˆ
â”œâ”€â”€ auto_access.py        # ìë™ ì ‘ê·¼ ëª¨ë“ˆ
â”œâ”€â”€ cookie_manager.py     # ì¿ í‚¤ ê´€ë¦¬ ëª¨ë“ˆ
â”œâ”€â”€ session_keeper.py     # ì„¸ì…˜ ìœ ì§€ ëª¨ë“ˆ
â”œâ”€â”€ mail_scraper.py       # ë©”ì¼ ìŠ¤í¬ë˜í•‘ ëª¨ë“ˆ
â”œâ”€â”€ mail_scraper_debug.py # ë©”ì¼ ìŠ¤í¬ë˜í•‘ ë””ë²„ê·¸
â”œâ”€â”€ test_system.py        # ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸
â”œâ”€â”€ utils.py             # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”œâ”€â”€ .env                 # ë¡œê·¸ì¸ ì •ë³´ (gitignore)
â””â”€â”€ data/
    â”œâ”€â”€ cookies.json     # ì €ì¥ëœ ì¿ í‚¤
    â”œâ”€â”€ *.xlsx          # ìˆ˜ì§‘ëœ ë©”ì¼ ë°ì´í„°
    â””â”€â”€ logs/           # ë¡œê·¸ íŒŒì¼

browser_profiles/       # ë¸Œë¼ìš°ì € í”„ë¡œí•„ (ë³„ë„ ê²½ë¡œ)
```

## ğŸ”§ ì£¼ìš” ê¸°ëŠ¥

### 1. ìˆ˜ë™ ë¡œê·¸ì¸ (`manual_login.py`)
- ë¸Œë¼ìš°ì € ì‹¤í–‰
- ë¡œê·¸ì¸ í˜ì´ì§€ ìë™ ì´ë™
- ì¿ í‚¤ ìˆ˜ì§‘ ë° ì €ì¥

### 2. ìë™ ì ‘ê·¼ (`auto_access.py`)
- ì¿ í‚¤ ë¡œë“œ
- ìë™ ë¡œê·¸ì¸
- ì‘ì—… ìˆ˜í–‰

### 3. ì¿ í‚¤ ê´€ë¦¬ (`cookie_manager.py`)
- ì¿ í‚¤ ì €ì¥/ë¡œë“œ
- ë§Œë£Œ ì‹œê°„ í™•ì¸
- ì¿ í‚¤ ê°±ì‹ 

### 4. ì„¸ì…˜ ìœ ì§€ (`session_keeper.py`)
- ì£¼ê¸°ì  ì„¸ì…˜ ê°±ì‹ 
- ë§Œë£Œ ì „ ì•Œë¦¼
- ìë™ ì¬ë¡œê·¸ì¸

### 5. ë©”ì¼ ìŠ¤í¬ë˜í•‘ (`mail_scraper.py`)
- ìë™ ë¡œê·¸ì¸ í›„ ë©”ì¼í•¨ ì ‘ì†
- ë°›ì€ ë©”ì¼í•¨ ë°ì´í„° ìˆ˜ì§‘
- í˜ì´ì§€ë„¤ì´ì…˜ ì§€ì› (ì—¬ëŸ¬ í˜ì´ì§€)
- Excel íŒŒì¼ë¡œ ìë™ ì €ì¥ (ë³´ë‚¸ì‚¬ëŒ, ì œëª©, ë‚ ì§œ)

## âš ï¸ ì£¼ì˜ì‚¬í•­

### ì‹¤íŒ¨ ì›ì¸ê³¼ í•´ê²°ì±…

| ë¬¸ì œ | ì›ì¸ | í•´ê²°ì±… |
|------|------|--------|
| 2ì°¨ ì¸ì¦ ê³„ì† ë°œìƒ | ìë™í™” ë„êµ¬ ê°ì§€ | ì¿ í‚¤ ì¬ì‚¬ìš© ë°©ì‹ ì‚¬ìš© |
| ì„¸ì…˜ ë§Œë£Œ | ì‹œê°„ ê²½ê³¼ | `session_keeper.py` ì‹¤í–‰ |
| PC ë³€ê²½ì‹œ ì‹¤íŒ¨ | ê¸°ê¸°ë³„ ì¿ í‚¤ | ìƒˆ PCì—ì„œ ìˆ˜ë™ ë¡œê·¸ì¸ 1íšŒ |
| ì ‘ê·¼ ê¶Œí•œ ì˜¤ë¥˜ | ì˜ëª»ëœ URL | `config.json`ì˜ URL ìˆ˜ì • |

## ğŸ”„ ìë™í™” í”„ë¡œì„¸ìŠ¤

```mermaid
graph LR
    A[ì‹œì‘] --> B{ì¿ í‚¤ ì¡´ì¬?}
    B -->|No| C[ìˆ˜ë™ ë¡œê·¸ì¸]
    C --> D[ì¿ í‚¤ ì €ì¥]
    D --> E[ìë™ ì ‘ê·¼]
    B -->|Yes| E
    E --> F{ì„¸ì…˜ ìœ íš¨?}
    F -->|Yes| G[ì‘ì—… ìˆ˜í–‰]
    F -->|No| C
```

## ğŸ“ ì„¤ì • íŒŒì¼ (`config.json`)

```json
{
  "credentials": {
    "username": "kilmoon@mek-ics.com",
    "password": "moon7410!@"
  },
  "urls": {
    "login": "https://ezsso.bizmeka.com/loginForm.do",
    "main": "https://www.bizmeka.com/",
    "app": "https://www.bizmeka.com/app/main.do"
  },
  "paths": {
    "cookies": "data/cookies.json",
    "profile": "C:\\projects\\autoinput\\browser_profiles\\bizmeka",
    "logs": "data/logs"
  },
  "settings": {
    "headless": false,
    "timeout": 30000,
    "keep_alive_interval": 86400
  }
}
```

## ğŸ› ï¸ ë¬¸ì œ í•´ê²° ê°€ì´ë“œ

### Q: 2ì°¨ ì¸ì¦ì´ ê³„ì† ë‚˜íƒ€ë‚©ë‹ˆë‹¤
A: ì •ìƒì…ë‹ˆë‹¤. ìµœì´ˆ 1íšŒëŠ” ìˆ˜ë™ìœ¼ë¡œ 2ì°¨ ì¸ì¦ì„ ì™„ë£Œí•´ì•¼ í•©ë‹ˆë‹¤.

### Q: ì¿ í‚¤ê°€ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤
A: `manual_login.py`ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì—¬ ìƒˆ ì¿ í‚¤ë¥¼ ì €ì¥í•˜ì„¸ìš”.

### Q: ë‹¤ë¥¸ PCì—ì„œ ì‚¬ìš©í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤
A: ìƒˆ PCì—ì„œ `manual_login.py`ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.

### Q: ìë™ìœ¼ë¡œ ì„¸ì…˜ì„ ìœ ì§€í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤
A: Windows ì‘ì—… ìŠ¤ì¼€ì¤„ëŸ¬ì— `session_keeper.py`ë¥¼ ë“±ë¡í•˜ì„¸ìš”.

## ğŸ“Š ë¡œê·¸ í™•ì¸
```bash
# ì˜¤ëŠ˜ ë¡œê·¸ í™•ì¸
python utils.py --show-logs today

# ì¿ í‚¤ ìƒíƒœ í™•ì¸
python cookie_manager.py --check-status
```

## ğŸ” ë³´ì•ˆ ì£¼ì˜
- `cookies.json` íŒŒì¼ì€ ë¯¼ê°í•œ ì •ë³´ì…ë‹ˆë‹¤
- Gitì— ì»¤ë°‹í•˜ì§€ ë§ˆì„¸ìš” (`.gitignore`ì— ì¶”ê°€)
- ì •ê¸°ì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì„¸ìš”

## ğŸ“ ë¬¸ì œ ë°œìƒì‹œ
1. `data/logs/` í´ë”ì˜ ë¡œê·¸ í™•ì¸
2. ì¿ í‚¤ íŒŒì¼ ì‚­ì œ í›„ ì¬ì‹œë„
3. ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ í›„ ì¬ì‹œë„

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„
- [ ] GUI ì¸í„°í˜ì´ìŠ¤ ì¶”ê°€
- [ ] ë‹¤ì¤‘ ê³„ì • ì§€ì›
- [ ] ìë™ ì‘ì—… ìŠ¤ì¼€ì¤„ë§
- [ ] ì—ëŸ¬ ìë™ ë³µêµ¬